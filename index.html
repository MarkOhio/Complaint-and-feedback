<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Complaint & Feedback Portal</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9aa4b2; --accent:#00aaff; --success:#08c78a;
      --danger:#ff5c5c; --glass: rgba(255,255,255,0.04);
      --radius:14px; --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;
      color-scheme: dark;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,white 0%, white 60%, white 100%);
      color:gray; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      padding:28px;
      display:flex; align-items:flex-start; justify-content:center;
    }
    .wrap{
      width:100%; max-width:1100px;
      display:grid; grid-template-columns: 420px 1fr; gap:22px;
    }
    header{
      grid-column:1 / -1; display:flex; align-items:center; gap:12px; margin-bottom:6px;
    }
    .brand{
      display:flex; gap:12px; align-items:center;
    }
    .logo{
      width:56px; height:56px; border-radius:12px; background:linear-gradient(135deg,var(--accent), #00ffc6);
      display:flex; align-items:center; justify-content:center; color:#04202a; font-weight:700; font-size:22px;
      box-shadow: 0 6px 30px rgba(0,170,255,0.08), inset 0 -6px 20px rgba(255,255,255,0.03);
    }
    h1{margin:0; font-size:18px; letter-spacing:0.2px}
    p.lead{margin:0; color:var(--muted); font-size:13px}
    /* Left column: form */
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius); padding:18px; box-shadow: 0 6px 30px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
    }
    form .row{display:flex; gap:10px}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    input[type=text], input[type=email], select, textarea{
      width:100%; padding:10px 12px; border-radius:10px; border:1px solid rgba(0, 0, 0, 0.685);
      background:var(--glass); color:inherit; font-size:14px; outline:none; resize:vertical;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02);
      transition: box-shadow .15s, transform .08s;
    }
    input:focus, select:focus, textarea:focus{box-shadow: 0 6px 20px rgba(0,170,255,0.06); transform:translateY(-1px)}
    .two{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    .controls{display:flex; gap:8px; margin-top:12px; align-items:center}
    button.btn{
      background:linear-gradient(90deg,var(--accent), #00ffc6);
      border:none; padding:10px 12px; border-radius:10px; color:#04202a; font-weight:700; cursor:pointer;
      box-shadow: 0 8px 30px rgba(0,170,255,0.08);
    }
    button.ghost{
      background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--muted); padding:10px 12px; border-radius:10px; cursor:pointer;
    }
    .muted{color:var(--muted); font-size:13px}
    .small{font-size:13px; color:var(--muted)}
    /* Right column: list */
    .toolbar{display:flex; gap:8px; align-items:center; justify-content:space-between; margin-bottom:12px}
    .searchbar{display:flex; gap:8px; align-items:center}
    .searchbar input{padding:8px 10px; min-width:220px}
    .chips{display:flex; gap:8px; align-items:center}
    .chip{padding:8px 10px; border-radius:999px; background:rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.02); font-size:13px; cursor:pointer}
    .list{display:grid; gap:10px; align-content:start; max-height:68vh; overflow:auto; padding-right:6px}
    .item{
      background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(0,0,0,0.02));
      border-radius:12px; padding:12px; display:flex; gap:12px; align-items:flex-start; border:1px solid rgba(255,255,255,0.02);
    }
    .meta{flex:1}
    .meta h3{margin:0; font-size:15px}
    .meta p{margin:6px 0 0 0; color:var(--muted); font-size:13px}
    .tags{display:flex; gap:8px; margin-top:8px}
    .tag{font-size:12px; padding:6px 8px; border-radius:999px; background:rgba(255,255,255,0.02); color:var(--muted)}
    .actions{display:flex; gap:6px; align-items:center}
    .actions button{background:transparent;border:none;color:var(--muted);cursor:pointer;padding:6px;border-radius:8px}
    .actions button:hover{background:rgba(255,255,255,0.02)}
    .badge{font-weight:700; padding:6px 8px; border-radius:10px; font-size:12px}
    .status-open{background:rgba(8,199,138,0.12); color:var(--success); border:1px solid rgba(8,199,138,0.08)}
    .status-closed{background:rgba(255,92,92,0.08); color:var(--danger); border:1px solid rgba(255,92,92,0.06)}
    .rating{display:flex; gap:4px; align-items:center}
    .star{font-weight:700; color:var(--muted); user-select:none}
    .star.filled{color:gold}
    /* modal */
    .modal-backdrop{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:linear-gradient(180deg,rgba(2,6,23,0.6), rgba(2,6,23,0.85)); z-index:60}
    .modal{width:min(680px,96%); background:linear-gradient(180deg,#071223 0%, #061018 100%); border-radius:12px; padding:18px; border:1px solid rgba(255,255,255,0.03)}
    .modal header{display:flex; justify-content:space-between; align-items:center; gap:8px}
    .modal h2{margin:0; font-size:16px}
    .row-justify{display:flex; justify-content:space-between; gap:12px; align-items:center}
    .empty{padding:36px; text-align:center; color:var(--muted)}
    footer.app-foot{grid-column:1/-1; margin-top:12px; color:var(--muted); font-size:13px; text-align:center}
    @media (max-width:980px){ .wrap{grid-template-columns:1fr; } header{flex-direction:column; align-items:flex-start} .card{order:2} .right{order:1}}
  </style>
</head>
<body>
  <main class="wrap" id="app">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden>CF</div>
        <div>
          <h1>Complaint & Feedback Portal</h1>
          <p class="lead">Submit, track, and export feedback.</p>
        </div>
      </div>
      <div style="margin-left:auto" aria-hidden>
        <div class="small">we care about your feedback</div>
      </div>
    </header>

    <section class="card" aria-labelledby="formTitle">
      <div style="display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:8px">
        <div>
          <div id="formTitle" style="font-weight:700">New Entry</div>
          <div class="muted" style="font-size:13px">Fill required fields before submitting.</div>
        </div>
        <div class="small">Entries stored in <code>secured database</code></div>
      </div>

      <form id="entryForm" autocomplete="off" novalidate>
        <div class="two">
          <div>
            <label for="name">Name <span class="muted">*</span></label>
            <input id="name" name="name" type="text" placeholder="Full name" required maxlength="80" />
          </div>
          <div>
            <label for="email">Email <span class="muted">*</span></label>
            <input id="email" name="email" type="email" placeholder="you@example.com" required maxlength="120" />
          </div>
        </div>

        <div style="display:flex; gap:10px; margin-top:10px">
          <div style="flex:1">
            <label for="type">Category</label>
            <select id="type" name="type">
              <option value="Complaint">Complaint</option>
              <option value="Feedback">Feedback</option>
              <option value="Suggestion">Suggestion</option>
              <option value="Praise">Praise</option>
            </select>
          </div>
          <div style="width:150px">
            <label for="priority">Priority</label>
            <select id="priority" name="priority">
              <option value="Low">Low</option>
              <option value="Normal" selected>Normal</option>
              <option value="High">High</option>
            </select>
          </div>
        </div>

        <div style="margin-top:10px">
          <label for="subject">Subject <span class="muted">*</span></label>
          <input id="subject" name="subject" type="text" placeholder="Short subject" maxlength="140" required />
        </div>

        <div style="margin-top:10px">
          <label for="message">Message <span class="muted">*</span></label>
          <textarea id="message" name="message" rows="6" placeholder="Describe the issue or feedback (max 1000 chars)" required maxlength="1000"></textarea>
          <div style="display:flex; justify-content:space-between; margin-top:6px; align-items:center">
            <div class="small">Be specific. Include steps to reproduce where applicable.</div>
            <div id="charCount" class="small">0 / 1000</div>
          </div>
        </div>

        <div style="margin-top:12px; display:flex; gap:12px; align-items:center; justify-content:space-between">
          <div style="display:flex; gap:8px; align-items:center">
            <label style="margin:0; font-size:13px; color:var(--muted)">Rate experience</label>
            <div id="rating" class="rating" role="radiogroup" aria-label="Rating">
              <span class="star" data-value="1">★</span>
              <span class="star" data-value="2">★</span>
              <span class="star" data-value="3">★</span>
              <span class="star" data-value="4">★</span>
              <span class="star" data-value="5">★</span>
            </div>
            <input type="hidden" id="ratingValue" name="rating" value="0" />
          </div>

          <div class="controls">
            <button type="submit" class="btn" id="submitBtn">Submit</button>
            <button type="button" class="ghost" id="clearFormBtn">Clear</button>
            <button type="button" class="ghost" id="importSampleBtn" title="Insert sample entry">Sample</button>
          </div>
        </div>
      </form>

      <div style="display:flex; gap:8px; margin-top:12px; align-items:center; justify-content:space-between">
        <div class="small">Actions</div>
        <div style="display:flex; gap:8px">
          <button id="exportBtn" class="ghost">Export CSV</button>
          <button id="clearAllBtn" class="ghost">Delete All</button>
        </div>
      </div>
    </section>

    <section class="right">
      <div style="display:flex; align-items:center; justify-content:space-between; margin-bottom:12px">
        <div class="toolbar">
          <div class="searchbar">
            <input id="search" placeholder="Search by name, subject or message" />
            <select id="filterType" style="padding:8px">
              <option value="">All categories</option>
              <option>Complaint</option>
              <option>Feedback</option>
              <option>Suggestion</option>
              <option>Praise</option>
            </select>
          </div>
        </div>
        <div class="chips">
          <div class="chip" id="sortBtn">Sort: Newest</div>
          <div class="chip" id="showOpenBtn">Show: All</div>
        </div>
      </div>

      <div class="card" style="padding:12px">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px">
          <div style="font-weight:700">Entries</div>
          <div class="muted" id="countLabel">0 entries</div>
        </div>
        <div class="list" id="listArea" aria-live="polite">
          <div class="empty" id="emptyState">No entries yet.</div>
        </div>
      </div>
    </section>

    <div class="modal-backdrop" id="modal" role="dialog" aria-modal="true" aria-hidden="true">
      <div class="modal" role="document">
        <header>
          <h2 id="modalTitle">View Entry</h2>
          <div style="display:flex; gap:8px; align-items:center">
            <button class="ghost" id="modalEditBtn">Edit</button>
            <button class="ghost" id="modalCloseBtn">Close</button>
          </div>
        </header>
        <div id="modalContent" style="margin-top:12px"></div>
      </div>
    </div>

    <footer class="app-foot">Data stays local. Use export to share. Built with HTML/CSS/JS.</footer>
  </main>

  <script>
    (function(){
      const LS_KEY = 'cf_submissions_v1';
      const form = document.getElementById('entryForm');
      const nameInput = document.getElementById('name');
      const emailInput = document.getElementById('email');
      const typeInput = document.getElementById('type');
      const priorityInput = document.getElementById('priority');
      const subjectInput = document.getElementById('subject');
      const messageInput = document.getElementById('message');
      const ratingStars = document.querySelectorAll('.star');
      const ratingValue = document.getElementById('ratingValue');
      const charCount = document.getElementById('charCount');
      const listArea = document.getElementById('listArea');
      const countLabel = document.getElementById('countLabel');
      const emptyState = document.getElementById('emptyState');
      const searchInput = document.getElementById('search');
      const filterType = document.getElementById('filterType');
      const sortBtn = document.getElementById('sortBtn');
      const showOpenBtn = document.getElementById('showOpenBtn');
      const exportBtn = document.getElementById('exportBtn');
      const clearAllBtn = document.getElementById('clearAllBtn');
      const clearFormBtn = document.getElementById('clearFormBtn');
      const importSampleBtn = document.getElementById('importSampleBtn');

      const modal = document.getElementById('modal');
      const modalTitle = document.getElementById('modalTitle');
      const modalContent = document.getElementById('modalContent');
      const modalCloseBtn = document.getElementById('modalCloseBtn');
      const modalEditBtn = document.getElementById('modalEditBtn');

      let submissions = []; // loaded from storage
      let sortNewest = true;
      let filterOpen = 'all'; // all / open / closed
      let editingId = null;

      /* Utilities */
      function uid(){ return Date.now().toString(36) + Math.random().toString(36).slice(2,8); }
      function nowISO(){ return new Date().toISOString(); }
      function saveAll(){ localStorage.setItem(LS_KEY, JSON.stringify(submissions)); }
      function loadAll(){
        try{
          const raw = localStorage.getItem(LS_KEY);
          submissions = raw ? JSON.parse(raw) : [];
        }catch(e){ submissions = []; }
      }

      /* Render list */
      function renderList(){
        listArea.innerHTML = '';
        const q = (searchInput.value||'').trim().toLowerCase();
        const typeFilter = filterType.value;
        let items = submissions.slice();
        if(typeFilter) items = items.filter(s => s.type === typeFilter);
        if(filterOpen === 'open') items = items.filter(s => s.status === 'Open');
        if(filterOpen === 'closed') items = items.filter(s => s.status === 'Closed');
        if(q) items = items.filter(s => (s.name+s.subject+s.message).toLowerCase().includes(q));
        items.sort((a,b) => sortNewest ? b.created.localeCompare(a.created) : a.created.localeCompare(b.created));
        countLabel.textContent = items.length + ' entries';
        if(items.length === 0){
          listArea.appendChild(emptyState);
          return;
        }
        items.forEach(s => {
          const el = document.createElement('div'); el.className = 'item'; el.dataset.id = s.id;
          const left = document.createElement('div'); left.style.width='46px'; left.style.flex='0 0 46px';
          left.innerHTML = `<div style="width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg, rgba(255,255,255,0.02), rgba(0,0,0,0.03));display:flex;align-items:center;justify-content:center;font-weight:700">${escapeHtml(s.name.slice(0,1) || 'U')}</div>`;
          const meta = document.createElement('div'); meta.className='meta';
          const title = document.createElement('h3'); title.textContent = s.subject || '(no subject)';
          const sub = document.createElement('p'); sub.className='muted'; sub.textContent = `${s.name} • ${s.email} • ${new Date(s.created).toLocaleString()}`;
          const tags = document.createElement('div'); tags.className='tags';
          const t1 = document.createElement('div'); t1.className='tag'; t1.textContent = s.type + ' • ' + s.priority;
          const t2 = document.createElement('div'); t2.className='tag'; t2.textContent = s.status;
          tags.appendChild(t1); tags.appendChild(t2);
          const excerpt = document.createElement('div'); excerpt.className='muted'; excerpt.style.marginTop='8px'; excerpt.textContent = s.message.length>160 ? s.message.slice(0,160)+'…' : s.message;
          meta.appendChild(title); meta.appendChild(sub); meta.appendChild(tags); meta.appendChild(excerpt);
          const actions = document.createElement('div'); actions.className='actions';
          const viewBtn = document.createElement('button'); viewBtn.title='View'; viewBtn.innerHTML='View';
          viewBtn.addEventListener('click', ()=> openModal(s.id));
          const editBtn = document.createElement('button'); editBtn.title='Quick Edit'; editBtn.innerHTML='Edit';
          editBtn.addEventListener('click', ()=> quickEdit(s.id));
          const delBtn = document.createElement('button'); delBtn.title='Delete'; delBtn.innerHTML='Delete';
          delBtn.addEventListener('click', ()=> doDelete(s.id));
          actions.appendChild(viewBtn); actions.appendChild(editBtn); actions.appendChild(delBtn);
          el.appendChild(left); el.appendChild(meta); el.appendChild(actions);
          listArea.appendChild(el);
        });
      }

      /* Escaping */
      function escapeHtml(s){ return String(s||'').replace(/[&<>"']/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]; }); }

      /* Form handling */
      function resetForm(){
        form.reset();
        ratingValue.value = '0';
        document.querySelectorAll('.star').forEach(st => st.classList.remove('filled'));
        charCount.textContent = '0 / 1000';
        editingId = null;
        submitBtn.textContent = 'Submit';
      }

      messageInput.addEventListener('input', ()=>{
        charCount.textContent = messageInput.value.length + ' / 1000';
      });

      ratingStars.forEach(st => st.addEventListener('click', (e)=>{
        const v = Number(st.dataset.value);
        ratingValue.value = v;
        ratingStars.forEach(s => s.classList.toggle('filled', Number(s.dataset.value) <= v));
      }));

      /* Validation */
      function validEmail(e){
        if(!e) return false;
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);
      }

      /* Submit */
      const submitBtn = document.getElementById('submitBtn');
      form.addEventListener('submit', function(ev){
        ev.preventDefault();
        const name = nameInput.value.trim();
        const email = emailInput.value.trim();
        const type = typeInput.value;
        const priority = priorityInput.value;
        const subject = subjectInput.value.trim();
        const message = messageInput.value.trim();
        const rating = Number(ratingValue.value) || 0;

        if(!name){ alert('Name required'); return; }
        if(!validEmail(email)){ alert('Valid email required'); return; }
        if(!subject){ alert('Subject required'); return; }
        if(!message){ alert('Message required'); return; }

        if(editingId){
          const idx = submissions.findIndex(s => s.id === editingId);
          if(idx>=0){
            submissions[idx] = Object.assign({}, submissions[idx], {name,email,type,priority,subject,message,rating,updated:nowISO()});
            saveAll(); loadAll(); renderList(); resetForm();
            return;
          }
        }

        const entry = {
          id: uid(),
          name, email, type, priority, subject, message, rating,
          status: 'Open',
          created: nowISO(),
          updated: nowISO()
        };
        submissions.push(entry); saveAll(); loadAll(); renderList(); resetForm();
      });

      /* Quick actions */
      function doDelete(id){
        if(!confirm('Delete entry?')) return;
        submissions = submissions.filter(s => s.id !== id);
        saveAll(); loadAll(); renderList();
      }

      function quickEdit(id){
        const s = submissions.find(x => x.id === id); if(!s) return;
        nameInput.value = s.name; emailInput.value = s.email; typeInput.value = s.type;
        priorityInput.value = s.priority; subjectInput.value = s.subject; messageInput.value = s.message;
        ratingValue.value = s.rating || 0;
        ratingStars.forEach(st => st.classList.toggle('filled', Number(st.dataset.value) <= Number(s.rating || 0)));
        editingId = id; submitBtn.textContent = 'Save';
        window.scrollTo({top:0, behavior:'smooth'});
      }

      /* Modal */
      function openModal(id){
        const s = submissions.find(x => x.id === id); if(!s) return;
        modalTitle.textContent = s.subject || 'Entry';
        modalContent.innerHTML = renderEntryDetails(s);
        modal.style.display = 'flex'; modal.setAttribute('aria-hidden','false');
        modalCloseBtn.onclick = closeModal;
        modalEditBtn.onclick = ()=> { quickEdit(id); closeModal(); };
        modal.addEventListener('click', backdropClick);
      }
      function closeModal(){
        modal.style.display='none'; modal.setAttribute('aria-hidden','true'); modal.removeEventListener('click', backdropClick);
      }
      function backdropClick(e){
        if(e.target === modal) closeModal();
      }

      function renderEntryDetails(s){
        const stars = Array.from({length:5}, (_,i)=> i < (s.rating||0) ? '★' : '☆').join('');
        return `
          <div style="display:flex;justify-content:space-between;align-items:center;gap:12px">
            <div>
              <div style="font-weight:700">${escapeHtml(s.subject)}</div>
              <div class="muted" style="margin-top:6px">${escapeHtml(s.name)} • ${escapeHtml(s.email)} • ${new Date(s.created).toLocaleString()}</div>
              <div style="margin-top:8px;display:flex;gap:8px"><div class="tag">${escapeHtml(s.type)}</div><div class="tag">${escapeHtml(s.priority)}</div><div class="tag">${escapeHtml(s.status)}</div></div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:800">${stars}</div>
            </div>
          </div>
          <div style="margin-top:12px; font-size:14px; color:var(--muted); white-space:pre-wrap">${escapeHtml(s.message)}</div>
          <div style="margin-top:12px; display:flex; gap:8px; justify-content:flex-end">
            <button class="ghost" id="modalToggleStatus">${s.status === 'Open' ? 'Mark Closed' : 'Reopen'}</button>
            <button class="ghost" id="modalDelete">Delete</button>
          </div>
        `;
      }

      /* Modal buttons delegation */
      document.addEventListener('click', function(e){
        if(e.target && e.target.id === 'modalToggleStatus'){
          const subj = modalTitle.textContent;
          const s = submissions.find(x => x.subject === subj || x.id === editingId);
          // safer: parse modalContent to find created date to identify entry
          const idAttr = findModalEntryId();
          const entry = submissions.find(x => x.id === idAttr);
          if(entry){
            entry.status = entry.status === 'Open' ? 'Closed' : 'Open';
            entry.updated = nowISO(); saveAll(); loadAll(); renderList(); openModal(entry.id);
          }
        } else if(e.target && e.target.id === 'modalDelete'){
          const idAttr = findModalEntryId();
          if(!idAttr) return;
          if(!confirm('Delete this entry?')) return;
          submissions = submissions.filter(s => s.id !== idAttr); saveAll(); loadAll(); renderList(); closeModal();
        }
      });

      function findModalEntryId(){
        // Attempt to identify entry by matching subject + timestamp string inside modal
        const subject = modalTitle.textContent;
        const createdLine = modalContent.querySelector('.muted') ? modalContent.querySelector('.muted').textContent : '';
        // fallback: match by subject (may be ambiguous)
        const candidates = submissions.filter(s => s.subject === subject);
        if(candidates.length === 1) return candidates[0].id;
        if(createdLine){
          for(const c of candidates){
            if(createdLine.includes(new Date(c.created).toLocaleDateString()) || createdLine.includes(new Date(c.created).toLocaleString().split(',')[0])) return c.id;
          }
        }
        return candidates[0] ? candidates[0].id : null;
      }

      /* Search/filter/sort */
      searchInput.addEventListener('input', debounce(renderList, 220));
      filterType.addEventListener('change', renderList);
      sortBtn.addEventListener('click', ()=>{
        sortNewest = !sortNewest;
        sortBtn.textContent = 'Sort: ' + (sortNewest ? 'Newest' : 'Oldest');
        renderList();
      });
      showOpenBtn.addEventListener('click', ()=>{
        filterOpen = filterOpen === 'all' ? 'open' : (filterOpen === 'open'? 'closed' : 'all');
        showOpenBtn.textContent = 'Show: ' + (filterOpen === 'all' ? 'All' : (filterOpen === 'open' ? 'Open only' : 'Closed only'));
        renderList();
      });

      /* Export CSV */
      exportBtn.addEventListener('click', ()=>{
        if(submissions.length === 0){ alert('No entries to export'); return; }
        const header = ['id','created','updated','name','email','type','priority','status','subject','message','rating'];
        const rows = submissions.map(s => header.map(k => csvSafe(s[k])).join(','));
        const csv = [header.join(','), ...rows].join('\\n');
        const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
        const u = URL.createObjectURL(blob);
        const a = document.createElement('a'); a.href = u; a.download = 'cf-entries.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(u);
      });

      function csvSafe(v){
        if(v === null || v === undefined) return '';
        const s = String(v).replace(/"/g,'""');
        return '"' + s + '"';
      }

      /* Clear all */
      clearAllBtn.addEventListener('click', ()=>{
        if(!confirm('Delete all entries?')) return;
        submissions = []; saveAll(); loadAll(); renderList();
      });

      clearFormBtn.addEventListener('click', ()=> resetForm());

      importSampleBtn.addEventListener('click', ()=>{
        nameInput.value = 'Jane Doe';
        emailInput.value = 'jane.doe@example.com';
        typeInput.value = 'Complaint';
        priorityInput.value = 'High';
        subjectInput.value = 'Unable to login to account';
        messageInput.value = 'I tried to sign in using my email but get a server error. Steps: 1) open login page 2) enter credentials 3) press sign in. Error: 500 internal server error. Please investigate.';
        ratingValue.value = 2;
        ratingStars.forEach(st => st.classList.toggle('filled', Number(st.dataset.value) <= 2));
        charCount.textContent = messageInput.value.length + ' / 1000';
      });

      /* Helpers */
      function debounce(fn, wait){ let t; return function(){ clearTimeout(t); t = setTimeout(()=> fn.apply(this, arguments), wait); }; }

      /* Initial load */
      loadAll();
      renderList();

      /* Simple accessibility: close modal on ESC */
      document.addEventListener('keydown', (e)=> { if(e.key === 'Escape') { if(modal.style.display === 'flex') closeModal(); else resetForm(); } });

      /* provide a minimal demonstration to user: add a sample if none exists */
      if(!submissions.length){
        // do not auto-persist sample; leave to user to import
      }
    })();
  </script>
</body>
</html>